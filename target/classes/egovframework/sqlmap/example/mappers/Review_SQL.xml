<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="egovframework.example.sample.service.impl.ReviewMapper">

	<resultMap id="review" type="egovframework.example.sample.service.ReviewVO">
		<result property="rv_id" column="rv_id"/>
		<result property="hpt_id" column="hpt_id"/>
		<result property="hpt_rate" column="hpt_rate"/>
		<result property="rv_title" column="rv_title"/>
		<result property="rv_content" column="rv_content"/>
		<result property="rv_reg_date" column="rv_reg_date"/>
		<result property="rv_image" column="rv_image"/>
		<result property="pet_type" column="pet_type"/>
		<result property="visit_date" column="visit_date"/>
		<result property="visit_is_new" column="visit_is_new"/>
		<result property="cmt_id" column="cmt_id"/>
		<result property="cmt_content" column="cmt_content"/>
		<result property="cmt_reg_date" column="cmt_reg_date"/>
	</resultMap>

	<!-- 후기 입력하기 -->
	<insert id="insertReview" parameterType="ReviewVO">
			INSERT INTO 
				review(hpt_id, hpt_rate, rv_title, rv_content, rv_image, pet_type, visit_date, visit_is_new)
			VALUES
				(#{hpt_id}, #{hpt_rate}, #{rv_title}, #{rv_content}, #{rv_image}, #{pet_type}, #{visit_date}, #{visit_is_new})
	</insert>
	<!-- AJAX로 랜덤 후기 등록 -->
	<insert id="insertReviewAjax" parameterType="ReviewVO">
			INSERT INTO 
				review(hpt_id, hpt_rate, rv_title, rv_content, rv_image, pet_type, visit_date, visit_is_new)
			VALUES
				(#{hpt_id}, #{hpt_rate}, #{rv_title}, #{rv_content}, #{rv_image}, #{pet_type}, #{visit_date}, #{visit_is_new})
	</insert>
	<!-- //AJAX로 랜덤 후기 등록 -->
	
	<!-- 후기 리스트 -->
	<select id="reviewList" resultType="egovMap">
			SELECT
				rv_id, hpt_id, rv_title, rv_content, hpt_rate,
				DATE_FORMAT(rv_reg_date, '%Y-%m-%d') AS rv_reg_date, 
				rv_image, pet_type, visit_date, visit_is_new
			FROM
				review
			WHERE 
				hpt_id=#{hpt_id}
			ORDER BY
				rv_id DESC
	</select>
	
	<!-- 후기 리스트 3개만 -->
	<select id="reviewListThree" resultType="egovMap">
			SELECT
				rv_id, hpt_id, rv_title, rv_content, 
				DATE_FORMAT(rv_reg_date, '%Y-%m-%d') AS rv_reg_date, 
				rv_image, pet_type, visit_date, visit_is_new
			FROM
				review
			WHERE 
				hpt_id=#{hpt_id}
			ORDER BY
				rv_id DESC
			LIMIT 0,3
	</select>
	
	<!-- 후기 상세 보기 -->
	<select id="reviewDetail" resultType="egovMap">
			SELECT
				rv_id, hpt_id, hpt_rate, rv_title, rv_content, 
				DATE_FORMAT(rv_reg_date, '%Y-%m-%d') AS rv_reg_date, 
				rv_image, pet_type, visit_date, visit_is_new
			FROM
				review
			WHERE 
				rv_id=#{rv_id}
	</select>
	
	

</mapper>